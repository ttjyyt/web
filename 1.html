<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰«é›·å¤§æŒ‘æˆ˜</title>
    <style>
        /* --- è§†é¢‘èƒŒæ™¯æ ·å¼ --- */
        #video-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: -1; opacity: 0.5;
        }

        /* --- æ•´ä½“é¡µé¢å¸ƒå±€ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            display: flex; justify-content: center; align-items: center;
            height: 100vh; margin: 0; color: #333;
        }
        
        #main-content { text-align: center; }

        h1 {
            color: white; font-size: 2.5em; text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
            margin-bottom: 20px;
        }

        /* --- æ¸¸æˆå®¹å™¨æ ·å¼ --- */
        #game-container {
            background-color: rgba(192, 192, 192, 0.95); padding: 15px;
            border: 3px solid; border-color: #fff #808080 #808080 #fff;
            box-shadow: 5px 5px 10px rgba(0,0,0,0.5); border-radius: 5px;
        }

        #header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px; margin-bottom: 10px; border: 3px solid;
            border-color: #808080 #fff #fff #808080;
        }

        .counter {
            background-color: #000; color: #ff0000; font-family: 'Courier New', Courier, monospace;
            font-size: 28px; font-weight: bold; padding: 5px 10px; border: 2px inset #808080;
        }

        #reset-button {
            width: 40px; height: 40px; font-size: 28px; border: 3px solid;
            border-color: #fff #808080 #808080 #fff; background-color: #c0c0c0;
            cursor: pointer; display: flex; justify-content: center; align-items: center;
        }
        
        #reset-button:active { border-color: #808080 #fff #fff #808080; }

        /* --- æ‰«é›·æ ¼å­æ ·å¼ --- */
        #grid { display: grid; border: 3px solid; border-color: #808080 #fff #fff #808080; }

        .cell {
            width: 30px; height: 30px; background-color: #c0c0c0; border: 2px solid;
            border-color: #fff #808080 #808080 #fff; box-sizing: border-box;
            display: flex; justify-content: center; align-items: center;
            font-size: 18px; font-weight: bold; cursor: pointer;
        }

        .cell.revealed { background-color: #bdbdbd; border: 1px solid #7b7b7b; }
        .cell.revealed.mine { background-color: red; }
        
        .c1 { color: #0000ff; } .c2 { color: #008000; } .c3 { color: #ff0000; }
        .c4 { color: #000080; } .c5 { color: #800000; } .c6 { color: #008080; }
        .c7 { color: #000000; } .c8 { color: #808080; }
        
        /* --- ç»“æœå¼¹çª—æ ·å¼ --- */
        #result-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.75); display: none;
            justify-content: center; align-items: center; z-index: 1000;
        }

        #result-box {
            background-color: #fff; padding: 25px; border-radius: 10px; text-align: center;
            max-width: 90%; max-height: 90%; box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        #result-box h2 { margin-top: 0; color: #333; }
        #result-box p { font-size: 1.1em; color: #555; }
        #result-box a { color: #007bff; text-decoration: none; font-weight: bold; word-break: break-all; }
        #result-box a:hover { text-decoration: underline; }
        #result-box img { max-width: 100%; height: auto; margin-top: 15px; border-radius: 5px; }

        /* --- ä¿®æ”¹åçš„æŒ‰é’®æ ·å¼ --- */
        #restart-challenge-button {
            margin-top: 20px; padding: 10px 25px; font-size: 1em; color: #fff;
            background-color: #007bff; border: none; border-radius: 5px;
            cursor: pointer; transition: background-color 0.2s;
        }
        #restart-challenge-button:hover { background-color: #0056b3; }

        /* è§†é¢‘æ§åˆ¶æŒ‰é’®å®¹å™¨ */
        #video-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 999;
            display: flex;
            gap: 10px; /* æŒ‰é’®ä¹‹é—´çš„é—´è· */
        }

        .control-button {
            padding: 10px 20px;
            font-size: 1em;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border: 1px solid white;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
        }
    </style>
</head>
<body>

<!-- èƒŒæ™¯è§†é¢‘ -->
<video id="video-background" muted loop playsinline src="https://vdse.bdstatic.com//9f1552101509ecbd5977405c692302c9.mp4"></video>

<!-- è§†é¢‘æ§åˆ¶æŒ‰é’®å®¹å™¨ -->
<div id="video-controls">
    <button id="video-control-button" class="control-button">æ’­æ”¾è§†é¢‘</button>
    <button id="sound-control-button" class="control-button">å¼€å¯èƒŒæ™¯éŸ³ä¹</button>
</div>

<!-- é¡µé¢ä¸»è¦å†…å®¹ -->
<div id="main-content">
    <h1>é€šå…³æ‰«é›·æœ‰å¥–åŠ±</h1>
    <div id="game-container">
        <div id="header">
            <div id="mine-counter" class="counter">010</div>
            <div id="reset-button">ğŸ˜Š</div>
            <div id="timer" class="counter">000</div>
        </div>
        <div id="grid"></div>
    </div>
</div>

<!-- ç»“æœæ˜¾ç¤ºå¼¹çª— -->
<div id="result-overlay">
    <div id="result-box">
        <!-- å†…å®¹å°†ç”±JavaScriptåŠ¨æ€å¡«å…… -->
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // è·å–å…ƒç´ 
    const video = document.getElementById('video-background');
    const videoControlButton = document.getElementById('video-control-button');
    const soundControlButton = document.getElementById('sound-control-button');
    const grid = document.getElementById('grid');
    const mineCounter = document.getElementById('mine-counter');
    const resetButton = document.getElementById('reset-button');
    const timerDisplay = document.getElementById('timer');
    const resultOverlay = document.getElementById('result-overlay');
    const resultBox = document.getElementById('result-box');

    // æ¸¸æˆè®¾ç½®
    const ROWS = 10, COLS = 10, MINES_COUNT = 10;
    let board = [], gameOver = false, flags = 0, firstClick = true, timer, time = 0;

    // --- ä¿®æ”¹åçš„è§†é¢‘æ§åˆ¶é€»è¾‘ ---
    videoControlButton.addEventListener('click', () => {
        if (video.paused) {
            video.play();
            videoControlButton.textContent = 'æš‚åœè§†é¢‘';
        } else {
            video.pause();
            videoControlButton.textContent = 'æ’­æ”¾è§†é¢‘';
        }
    });

    // --- ä¿®æ”¹åçš„å£°éŸ³æ§åˆ¶é€»è¾‘ ---
    soundControlButton.addEventListener('click', () => {
        video.muted = !video.muted; // åˆ‡æ¢é™éŸ³çŠ¶æ€
        soundControlButton.textContent = video.muted ? 'å¼€å¯èƒŒæ™¯éŸ³ä¹' : 'å…³é—­èƒŒæ™¯éŸ³ä¹';
    });


    // --- æ¸¸æˆé€»è¾‘ (æœªæ”¹å˜) ---
    function init() {
        gameOver = false;
        firstClick = true;
        flags = 0;
        grid.innerHTML = '';
        grid.style.gridTemplateColumns = `repeat(${COLS}, 30px)`;
        resetButton.textContent = 'ğŸ˜Š';
        resultOverlay.style.display = 'none';
        updateMineCounter();
        stopTimer();
        timerDisplay.textContent = '000';
        board = Array.from({ length: ROWS }, (_, r) => 
            Array.from({ length: COLS }, (_, c) => ({
                r, c, isMine: false, isRevealed: false, isFlagged: false, neighborMines: 0,
                element: createCellElement(r, c)
            }))
        );
    }
    function createCellElement(r, c) {
        const cell = document.createElement('div');
        cell.classList.add('cell');
        cell.addEventListener('click', () => onCellClick(r, c));
        cell.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            onRightClick(r, c);
        });
        grid.appendChild(cell);
        return cell;
    }
    function onCellClick(r, c) {
        if (gameOver || board[r][c].isRevealed || board[r][c].isFlagged) return;
        if (firstClick) {
            placeMines(r, c);
            startTimer();
            firstClick = false;
        }
        const cell = board[r][c];
        revealCell(cell);
        if (cell.isMine) {
            endGame(false);
        } else {
            checkWin();
        }
    }
    function endGame(isWin) {
        gameOver = true;
        stopTimer();
        resultOverlay.style.display = 'flex';
        if (isWin) {
            resetButton.textContent = 'ğŸ˜';
            resultBox.innerHTML = `
                <h2>æ­å–œä½ æŒ‘æˆ˜æˆåŠŸï¼</h2>
                <p>å‘Šè¯‰ä½ ä¸€ä¸ªæœ€å¼ºAIç½‘ç«™ï¼š</p>
                <a href="https://fumu-gender.netlify.app" target="_blank">https://fumu-gender.netlify.app</a>
            `;
        } else {
            resetButton.textContent = 'ğŸ˜µ';
            resultBox.innerHTML = `
                <h2>æŒ‘æˆ˜å¤±è´¥</h2>
                <img src="https://tse2.mm.bing.net/th/id/OIP.rZisMmSKzRIYJvjY-WUp6QHaHa?dpr=2&pid=ImgDetMain&o=7&rm=3" alt="æŒ‘æˆ˜å¤±è´¥">
                <br>
                <button id="restart-challenge-button">é‡æ–°æŒ‘æˆ˜</button>
            `;
            document.getElementById('restart-challenge-button').addEventListener('click', init);
            board.forEach(row => row.forEach(cell => {
                if (cell.isMine) revealCell(cell);
            }));
        }
    }
    function placeMines(firstR, firstC) {
        let minesPlaced = 0;
        while (minesPlaced < MINES_COUNT) {
            const r = Math.floor(Math.random() * ROWS), c = Math.floor(Math.random() * COLS);
            if (!board[r][c].isMine && !(r === firstR && c === firstC)) {
                board[r][c].isMine = true;
                minesPlaced++;
            }
        }
        for (let r = 0; r < ROWS; r++) for (let c = 0; c < COLS; c++) if (!board[r][c].isMine) {
            let count = 0;
            getNeighbors(r, c).forEach(n => { if (n.isMine) count++; });
            board[r][c].neighborMines = count;
        }
    }
    function getNeighbors(r, c) {
        const neighbors = [];
        for (let dr = -1; dr <= 1; dr++) for (let dc = -1; dc <= 1; dc++) {
            if (dr === 0 && dc === 0) continue;
            const nr = r + dr, nc = c + dc;
            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS) neighbors.push(board[nr][nc]);
        }
        return neighbors;
    }
    function revealCell(cell) {
        if (cell.isRevealed || cell.isFlagged) return;
        cell.isRevealed = true;
        cell.element.classList.add('revealed');
        if (cell.isMine) {
            cell.element.classList.add('mine'); cell.element.textContent = 'ğŸ’£';
        } else if (cell.neighborMines > 0) {
            cell.element.textContent = cell.neighborMines; cell.element.classList.add(`c${cell.neighborMines}`);
        } else { getNeighbors(cell.r, cell.c).forEach(n => revealCell(n)); }
    }
    function onRightClick(r, c) {
        if (gameOver || board[r][c].isRevealed) return;
        const cell = board[r][c];
        cell.isFlagged = !cell.isFlagged;
        cell.element.textContent = cell.isFlagged ? 'ğŸš©' : '';
        flags += cell.isFlagged ? 1 : -1;
        updateMineCounter();
    }
    function updateMineCounter() {
        let count = MINES_COUNT - flags;
        mineCounter.textContent = count.toString().padStart(3, '0');
    }
    function startTimer() {
        if(timer) clearInterval(timer);
        time = 0;
        timerDisplay.textContent = '000';
        timer = setInterval(() => {
            time++;
            if (time < 1000) timerDisplay.textContent = time.toString().padStart(3, '0');
        }, 1000);
    }
    function stopTimer() { clearInterval(timer); }
    function checkWin() {
        const revealedNonMines = board.flat().filter(c => c.isRevealed && !c.isMine).length;
        const totalNonMines = ROWS * COLS - MINES_COUNT;
        if (revealedNonMines === totalNonMines) endGame(true);
    }
    resetButton.addEventListener('click', init);
    init();
});
</script>

</body>
</html>
